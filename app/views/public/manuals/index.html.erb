<section class="hero is-warning">
  <div class="hero-body">
    <div class="container">
      <h2 class="title">
        マニュアル一覧
      </h2>
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-6">

        <div class="field">
          <%= form_with url: public_manuals_path, local: true, method: :get do |f| %>
            <%= f.label :キーワード、又は登録ジャンルから検索, class: "label" %>
            <%= f.text_field :keyword, placeholder: "例:　分析" %>
            <%= f.submit "検索", class: "button is-small is-success" %>
          <% end %>
        </div>
        <div class="field">
          <%= form_with url: public_manuals_path, local: true, method: :get do |f| %>
            <%= f.select :keyword, Genre.all.map { |genre| [genre.name, genre.name] } %>
            <%= f.submit "検索", class: "button is-small is-success" %>
          <% end %>
        </div>

        <div class="field">
          <p>
            <% if @keyword == Genre.all %>
              <span>”オール"</span>
            <% else %>
              "<%= @keyword %>"
            <% end %>
            での検索結果
          </p>
        </div>

        <table class="table">
          <thead class="bg-light">
            <tr>
              <th>業務</th>
              <th>タスク</th>
              <th>更新日</th>
            </tr>
          </thead>
          <% @genres.each do |genre| %>
            <% genre.manuals.each do |manual| %>
              <% if manual.is_draft == false %>
                <tbody>
                  <tr>
                    <td><%= manual.genre.name %></td>
                    <td>
                      <%= link_to public_manual_path(manual.id) do %>
                      <%= manual.task_name %>
                      <% end %>
                    </td>
                    <td><%= manual.updated_at.strftime("%Y/%m/%d") %></td>
                  </tr>
                </tbody>
              <% else %>
              <% end %>
            <% end %>
          <% end %>
        </table>

      </div>
    </div>
  </div>
</section>
